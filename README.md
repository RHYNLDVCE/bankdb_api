# Django Bank API

A Django REST API for bank customers, accounts, and transactions.

## Prerequisites
- Docker
- Docker Compose plugin (or Docker Compose v2)

## First-time setup (Docker)
1. Build images:
   ```sh
   docker compose build
   ```
2. Start services:
   ```sh
   docker compose up -d
   ```
3. Apply migrations:
   ```sh
   docker compose exec web python manage.py migrate
   ```
4. Create a superuser:
   ```sh
   docker compose exec web python manage.py createsuperuser
   ```

The app will be available at: http://localhost:8500

## Daily commands
- Start:
  ```sh
  docker compose up -d
  ```
- Stop:
  ```sh
  docker compose down
  ```
- Run tests:
  ```sh
  docker compose exec web python manage.py test
  ```

## Authentication
All API endpoints (except registration) require token authentication.

- Obtain token: `POST /api/get-token/`
- Include the token in the Authorization header for authenticated requests:
  ```
  Authorization: Token <your_token_here>
  ```

## API Endpoints (summary)
Base path: `/api/`

- Registration
  - `POST /api/register/` (public)
    Example request body:
    ```json
    {
      "username": "newuser",
      "password": "a-strong-password123",
      "full_name": "New Test User",
      "email": "new@example.com",
      "phone_number": "555-1234",
      "date_of_birth": "1995-05-15",
      "gender": "F"
    }
    ```
    Success (201):
    ```json
    { "username": "newuser", "email": "new@example.com" }
    ```

- Authentication
  - `POST /api/get-token/`
    Request:
    ```json
    { "username": "your_username", "password": "your_password" }
    ```
    Success (200):
    ```json
    { "token": "<token>" }
    ```

- Customers
  - `GET, POST /api/customers/` — list/create customer profiles linked to the authenticated user.

- Accounts
  - `GET, POST /api/accounts/` — list/create bank accounts for the authenticated user.
  - `POST /api/accounts/{id}/deposit/` — body: `{ "amount": "500.25" }`
  - `POST /api/accounts/{id}/withdraw/` — body: `{ "amount": "100.00" }`
  - `POST /api/accounts/{id}/transfer/` — body: `{ "to_account_number": "ACC-123456789", "amount": "150.00" }`

- Transactions
  - `GET /api/transactions/` — list all transaction records for the user's accounts (read-only).

## Notes
- Account numbers are autogenerated.
- Transactions are created by account actions (deposit / withdraw / transfer).
- Use `docker compose exec web python manage.py makemigrations` and `migrate` after model changes.
